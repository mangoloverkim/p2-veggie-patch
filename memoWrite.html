<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë©”ëª¨ ì‘ì„±</title>
  <style>
    body {
      background-color: white;
      font-family: "Gowun Dodum", sans-serif;
      text-align: center;
      padding: 40px;
      color: black;
    }

    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }

    textarea {
      width: 80%;
      height: 150px;
      font-size: 1em;
      padding: 10px;
      border: 2px solid #ccc;
      border-radius: 10px;
      resize: none;
    }

    .button {
      background-color: #cccccc;
      color: black;
      font-size: 1em;
      padding: 10px 20px;
      margin: 15px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-family: "Chiron Sung HK", serif;
    }

    img {
      height: 250px;
      margin: 10px;
    }
  </style>
</head>
<body>
  <h1 id="potTitle">í™”ë¶„ ì´ë¦„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h1>

  <!-- ì‹ë¬¼ ì´ë¯¸ì§€ -->
  <div>
    <img id="goodPlant" src="" alt="ì¢‹ì€ ì±„ì†Œ">
    <img id="badPlant" src="" alt="ë‚˜ìœ ì±„ì†Œ">
  </div>

  <!-- ë©”ëª¨ ì…ë ¥ -->
  <div>
    <textarea id="memo" placeholder="ì˜¤ëŠ˜ì˜ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš” :)"></textarea>
  </div>

  <!-- ë²„íŠ¼ -->
  <div>
    <button class="button" onclick="saveMemo('good')">ì¢‹ì€ í•˜ë£¨ ğŸ˜Š</button>
    <button class="button" onclick="saveMemo('bad')">ë‚˜ìœ í•˜ë£¨ ğŸ˜”</button>
    <button class="button" onclick="location.href='memoList.html'"> ë©”ëª¨ ë¦¬ìŠ¤íŠ¸</button>
    <button class="button" onclick="location.href='index.html'"> ì²˜ìŒìœ¼ë¡œ</button>
  </div>

  <script>
    const potName = localStorage.getItem("selectedPot");
    const title = document.getElementById("potTitle");
    const memoInput = document.getElementById("memo");

    if (!potName) {
      alert("ì„ íƒëœ í™”ë¶„ì´ ì—†ì–´ìš”!");
      location.href = "index.html";
    } else {
      title.innerText = `'${potName}' í™”ë¶„`;
    }

    const plantType = localStorage.getItem(`plantType_${potName}`) || "tomato";
    const maxStage = 4;

    function updateImages() {
      const data = JSON.parse(localStorage.getItem("memoData")) || {};
      const thisPot = data[potName] || { good: [], bad: [] };
      const goodCount = thisPot.good.length;
      const badCount = thisPot.bad.length;

      const goodStage = Math.min(goodCount, maxStage);
      const badStage = Math.min(badCount, maxStage);

      document.getElementById("goodPlant").src = `images/${plantType}_good_${goodStage}.png`;
      document.getElementById("badPlant").src = `images/${plantType}_bad_${badStage}.png`;
    }

    updateImages(); // ì´ˆê¸° ì´ë¯¸ì§€ í‘œì‹œ

    function saveMemo(type) {
      const content = memoInput.value.trim();
      if (content === "") {
        alert("ë©”ëª¨ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        return;
      }

      const allData = JSON.parse(localStorage.getItem("memoData")) || {};
      if (!allData[potName]) {
        allData[potName] = { good: [], bad: [] };
      }

      allData[potName][type].push({
        text: content,
        date: new Date().toISOString(),
      });

      localStorage.setItem("memoData", JSON.stringify(allData));

      memoInput.value = ""; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
      updateImages(); // ì´ë¯¸ì§€ ê°±ì‹ 
    }
  </script>
</body>
</html>
